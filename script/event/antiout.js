module.exports.config = {
  name: "antiout",
  version: "1.0.0"
};

module.exports.handleEvent = async ({ event, api }) => {
  // Pag-check kung ang bot mismo ang umalis
  if (event.logMessageData?.leftParticipantFbId === api.getCurrentUserID()) return;

  // Para sa umaalis na member
  if (event.logMessageType === 'log:unsubscribe') {
    if (event.logMessageData?.leftParticipantFbId) {
      const info = await api.getUserInfo(event.logMessageData?.leftParticipantFbId);
      const { name } = info[event.logMessageData?.leftParticipantFbId];

      // Kunin ang pangalan ng group chat
      const threadInfo = await api.getThreadInfo(event.threadID);
      const groupName = threadInfo.threadName || "ğ—šğ—¥ğ—¢ğ—¨ğ—£ ğ—–ğ—›ğ—”ğ—§";

      // Pag-send ng leaving message
      api.sendMessage(`ğŸ’” ğ—šğ—¼ğ—¼ğ—±ğ—¯ğ˜†ğ—², ${name}! ğ—¬ğ—¼ğ˜‚'ğ—¹ğ—¹ ğ—±ğ—²ğ—³ğ—¶ğ—»ğ—¶ğ˜ğ—²ğ—¹ğ˜† ğ—¯ğ—² ğ—ºğ—¶ğ˜€ğ˜€ğ—²ğ—±! ğŸ˜­ ğ—ªğ—² ğ—µğ—¼ğ—½ğ—² ğ˜ğ—¼ ğ˜€ğ—²ğ—² ğ˜†ğ—¼ğ˜‚ ğ—®ğ—´ğ—®ğ—¶ğ—» ğ˜€ğ—¼ğ—¼ğ—»! ğŸ‘‹ ğ—¦ğ˜ğ—®ğ˜† ğ˜€ğ—®ğ—³ğ—² ğ—®ğ—»ğ—± ğ˜ğ—®ğ—¸ğ—² ğ—°ğ—®ğ—¿ğ—²! ğŸŒŸ ${groupName}.`, event.threadID);

      // Awtomatikong pag-readd kung gusto mo itong i-enable
      api.addUserToGroup(event.logMessageData?.leftParticipantFbId, event.threadID, (error) => {
        if (error) {
          api.sendMessage(`ğ—¨ğ—»ğ—®ğ—¯ğ—¹ğ—² ğ˜ğ—¼ ğ—¿ğ—²-ğ—®ğ—±ğ—± ğ—ºğ—²ğ—ºğ—¯ğ—²ğ—¿ ${name} ğ˜ğ—¼ ${groupName}!ğŸª¦`, event.threadID);
        } else {
          api.sendMessage(`ğ—”ğ—°ğ˜ğ—¶ğ˜ƒğ—² ğ—®ğ—»ğ˜ğ—¶ğ—¼ğ˜‚ğ˜ ğ—ºğ—¼ğ—±ğ—², ${name} ğ—µğ—®ğ˜€ ğ—¯ğ—²ğ—²ğ—» ğ—¿ğ—²-ğ—®ğ—±ğ—±ğ—²ğ—± ğ˜ğ—¼ ${groupName} ğ˜€ğ˜‚ğ—°ğ—°ğ—²ğ˜€ğ˜€ğ—³ğ˜‚ğ—¹ğ—¹ğ˜†!`, event.threadID);
        }
      });
    }
  }

  // Para sa bagong sumasali na member
  if (event.logMessageType === 'log:subscribe') {
    if (event.logMessageData?.addedParticipants) {
      const threadInfo = await api.getThreadInfo(event.threadID);
      const groupName = threadInfo.threadName || "ğ—šğ—¥ğ—¢ğ—¨ğ—£ ğ—–ğ—›ğ—”ğ—§";

      const welcomeMessages = [
        `ğŸŠ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ğ˜ğ—µğ—² ğ—´ğ—¿ğ—¼ğ˜‚ğ—½! ğŸŒŸ ${groupName}, ${name}!ğŸ¥³ ğ—ªğ—²â€™ğ—¿ğ—² ğ—´ğ—¹ğ—®ğ—± ğ˜†ğ—¼ğ˜‚ ğ—·ğ—¼ğ—¶ğ—»ğ—²ğ—± ğ˜‚ğ˜€! ğŸ¤© ğ——ğ—¼ğ—»â€™ğ˜ ğ—¯ğ—² ğ˜€ğ—µğ˜†, ğ—³ğ—²ğ—²ğ—¹ ğ—³ğ—¿ğ—²ğ—² ğ˜ğ—¼ ğ—°ğ—µğ—®ğ˜! ğŸ’¬`,
        `ğŸ‰ ğ—›ğ—²ğ—¹ğ—¹ğ—¼ ${name}! ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ${groupName}! ğŸ¥³ ğ—šğ—¹ğ—®ğ—± ğ˜ğ—µğ—®ğ˜ ğ˜†ğ—¼ğ˜‚'ğ—¿ğ—² ğ—µğ—²ğ—¿ğ—²! ğŸ˜„ ğ—›ğ—®ğ˜ƒğ—² ğ—³ğ˜‚ğ—» ğ—°ğ—µğ—®ğ˜ğ˜ğ—¶ğ—»ğ—´! ğŸ’¬`,
        `ğŸŠ ğ—›ğ—²ğ—¹ğ—¹ğ—¼, ${name}! ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ${groupName}! ğŸŒŸ ğ—ªğ—² ğ—µğ—¼ğ—½ğ—² ğ˜†ğ—¼ğ˜‚ ğ—µğ—®ğ—©ğ—² ğ—® ğ—´ğ—¿ğ—²ğ—®ğ˜ ğ˜ğ—¶ğ—ºğ—² ğ—µğ—²ğ—¿ğ—²! ğŸ’¬âœ¨`,
        `ğŸ‰ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ğ—¼ğ˜‚ğ—¿ ğ—šğ—¥ğ—¢ğ—¨ğ—£ ğ—–ğ—›ğ—”ğ—§, ${name}! ğŸ¥³ ğ—ªğ—²'ğ—¿ğ—² ğ—µğ—®ğ—½ğ—½ğ˜† ğ˜ğ—µğ—®ğ˜ ğ˜†ğ—¼ğ˜‚ ğ—·ğ—¼ğ—¶ğ—»ğ—²ğ—±! ğŸ‰`,
        `ğŸŠ ğ—£ğ—¹ğ—²ğ—®ğ˜€ğ—®ğ—»ğ˜ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—², ${name}! ğ—ªğ—²â€™ğ—¿ğ—² ğ—´ğ—¹ğ—®ğ—± ğ˜ğ—µğ—®ğ˜ ğ˜†ğ—¼ğ˜‚'ğ—¿ğ—² ğ—µğ—²ğ—¿ğ—² ğ˜„ğ—¶ğ˜ğ—µ ğ˜‚ğ˜€! ğŸ’¬ğŸŒŸ`,
        `ğŸ‰ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ${groupName}, ${name}! ğŸ¥³ ğ—§ğ—µğ—² ğ—³ğ—®ğ—ºğ—¶ğ—¹ğ˜† ğ—·ğ˜‚ğ˜€ğ˜ ğ—´ğ—¼ğ˜ ğ—¯ğ—²ğ—®ğ˜‚ğ˜ğ—¶ğ—³ğ˜‚ğ—¹ğ—¹ğ˜† ğ—Ÿğ—œğ—©ğ—˜! ğŸŠ`,
        `ğŸŠ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—², ${name}! ğŸŒŸ ğ—ªğ—² ğ—µğ—¼ğ—½ğ—² ğ˜†ğ—¼ğ˜‚ ğ—²ğ—»ğ—·ğ—¼ğ˜† ğ—°ğ—µğ—®ğ˜ğ˜ğ—¶ğ—»ğ—´ ğ˜„ğ—¶ğ˜ğ—µ ğ˜‚ğ˜€! ğŸ’¬ğŸ‰`,
        `ğŸ‰ ğ—›ğ—²ğ—¹ğ—¹ğ—¼ ${name}! ğ—¬ğ—¼ğ˜‚'ğ—¿ğ—² ğ—»ğ—¼ğ˜„ ğ—® ğ—½ğ—®ğ—¿ğ˜ ğ—¼ğ—³ ğ—§ğ—›ğ—˜ ğ—šğ—¥ğ—¢ğ—¨ğ—£! ğŸŠ ğ—›ğ—®ğ—©ğ—² ğ—³ğ˜‚ğ—»! ğŸ¥³`,
        `ğŸŠ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ğ˜ğ—µğ—² ğ—´ğ—¿ğ—¼ğ˜‚ğ—½, ${name}! ğŸ¥³ ğ—ªğ—² ğ—µğ—®ğ˜ƒğ—² ğ—® ğ—šğ—¥ğ—˜ğ—”ğ—§ ğ˜ğ—¶ğ—ºğ—² ğ—®ğ—µğ—²ğ—®ğ—± ğ˜‚ğ˜€! ğŸ’¬`,
        `ğŸ‰ ğ—›ğ—²ğ—¹ğ—¹ğ—¼ ${name}! ğ—” ğ—ªğ—®ğ—¿ğ—º ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ${groupName}! ğŸ¥³ ğ—£ğ—¹ğ—²ğ—®ğ˜€ğ—² ğ—³ğ—²ğ—²ğ—¹ ğ—³ğ—¿ğ—²ğ—² ğ˜ğ—¼ ğ˜ğ—®ğ—¹ğ—¸ ğ—®ğ—»ğ—± ğ—²ğ—»ğ—·ğ—¼ğ˜†! ğŸŠ`,
        `ğŸŠ ğ—šğ—²ğ—»ğ˜ğ—¹ğ—²ğ—ºğ—²ğ—» ğ—®ğ—»ğ—± ğ—Ÿğ—®ğ—±ğ—¶ğ—²ğ˜€, ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ${name} ğ˜ğ—¼ ğ—§ğ—›ğ—˜ ğ—™ğ—”ğ— ğ—œğ—Ÿğ—¬! ğŸ‰ ğ—–ğ—µğ—®ğ˜ğ˜ğ—¶ğ—»ğ—´ ğ—¯ğ—²ğ—´ğ—¶ğ—»ğ˜€! âœ¨`,
        `ğŸ‰ ğ—šğ—¿ğ—²ğ—®ğ˜ ğ˜ğ—¼ ğ˜€ğ—²ğ—² ğ˜†ğ—¼ğ˜‚, ${name}! ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ğ—–ğ—›ğ—”ğ—§ğ—§ğ—˜ğ—¥ğ—¦ ğ—™ğ—¢ğ—¥ ğ—˜ğ—©ğ—˜ğ—¥! ğŸ’¬`,
        `ğŸŠ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—², ${name}! ğ—§ğ—µğ—² ğ—³ğ—®ğ—ºğ—¶ğ—¹ğ˜† ğ—·ğ˜‚ğ˜€ğ˜ ğ—´ğ—¼ğ˜ ğ—¯ğ—²ğ—®ğ˜‚ğ˜ğ—¶ğ—³ğ˜‚ğ—¹ğ—¹ğ˜† ğ—Ÿğ—œğ—©ğ—˜! ğŸ‰`,
        `ğŸ‰ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ—µğ—¼ğ—ºğ—², ${name}! ğŸŒŸ ğ—ªğ—² ğ—µğ—®ğ˜ƒğ—² ğ—³ğ—®ğ—»ğ—³ğ—®ğ˜€ğ˜ğ—¶ğ—° ğ— ğ—¢ğ— ğ—˜ğ—¡ğ—§ğ—¦ ğ—®ğ—µğ—²ğ—®ğ—±! ğŸŠ`,
        `ğŸŠ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ—®ğ—¯ğ—¼ğ—®ğ—¿ğ—±, ${name}! ğŸ¥³ ğ—Ÿğ—²ğ˜'ğ˜€ ğ—µğ—®ğ˜ƒğ—² ğ—³ğ—¨ğ—¡ ğ˜ğ—¼ğ—´ğ—²ğ˜ğ—µğ—²ğ—¿! ğŸ‰`,
        `ğŸ‰ ğ——ğ—²ğ—®ğ—¿ ${name}, ğ—›ğ—²ğ—¹ğ—¹ğ—¼ ğ—®ğ—»ğ—± ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ğ˜ğ—¼ ğ˜ğ—µğ—² ğ—™ğ—”ğ— ğ—œğ—Ÿğ—¬! ğŸŠ ğ—˜ğ—»ğ—·ğ—¼ğ˜† ğ˜ğ—µğ—² ğ—ğ—¢ğ—¨ğ—¥ğ—¡ğ—˜ğ—¬! ğŸ¥³`,
        `ğŸŠ ğ—ªğ—²ğ—¹ğ—°ğ—¼ğ—ºğ—² ${name}! ğŸ¥³ ğ—¡ğ—¢ğ—§ğ—›ğ—œğ—¡ğ—š ğ—•ğ—¨ğ—§ ğ—™ğ—¨ğ—¡ ğ—µğ—²ğ—¿ğ—² ğ—¶ğ—» ${groupName}! ğŸ‰`
      ];

      const randomMessage = welcomeMessages[Math.floor(Math.random() * welcomeMessages.length)];

      // Pag-send ng welcoming message
      api.sendMessage(randomMessage, event.threadID);
    }
  }
};
